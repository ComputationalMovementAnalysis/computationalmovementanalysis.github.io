<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2 Exercise 1 | Computational Movement Analysis: Patterns and Trends in Environmental Data</title>
<meta name="author" content="Patrick Laube, Nils Ratnaweera, Nikolaos Bakogiannis">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="2 Exercise 1 | Computational Movement Analysis: Patterns and Trends in Environmental Data">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2 Exercise 1 | Computational Movement Analysis: Patterns and Trends in Environmental Data">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<meta name="description" content="This exercise covers the necessary steps for getting ready in R and some basic concepts for setting up a well-structured R project. The lesson introduces how additional packages that provide...">
<meta property="og:description" content="This exercise covers the necessary steps for getting ready in R and some basic concepts for setting up a well-structured R project. The lesson introduces how additional packages that provide...">
<meta name="twitter:description" content="This exercise covers the necessary steps for getting ready in R and some basic concepts for setting up a well-structured R project. The lesson introduces how additional packages that provide...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Master ENR, Spring Semester 2022">Computational Movement Analysis: Patterns and Trends in Environmental Data</a>:
        <small class="text-muted">Master ENR, Spring Semester 2022</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to the course!</a></li>
<li><a class="" href="license.html">License</a></li>
<li><a class="" href="w0-preparation.html"><span class="header-section-number">1</span> Preparation</a></li>
<li><a class="active" href="exercise-1.html"><span class="header-section-number">2</span> Exercise 1</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="exercise-1" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"><i class="fas fa-link"></i></a>
</h1>
<p>This exercise covers the necessary steps for getting ready in <code>R</code> and some basic concepts for setting up a well-structured <code>R</code> project. The lesson introduces how additional packages that provide useful functions for data science are made available and how spatial data is handled. The exercise concludes with the creation of your first map featuring movement data.</p>
<p><strong>Learning Outcomes</strong>*</p>
<ul>
<li>You learn how to structure an <code>R</code> project.</li>
<li>You can read movement data from a .csv-file into a <code>data.frame</code>
</li>
<li>You can convert spatial point data from a <code>data.frame</code> to a spatial object <code>sf</code>
</li>
<li>You can perform basic spatial operations on spatial objects in <code>R</code>
</li>
<li>You can produce simple maps of your spatial data using <code>ggplot2</code>
</li>
<li>You can produce simple maps of your spatial data using <code>tmap</code>
</li>
</ul>
<div id="slides" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Slides<a class="anchor" aria-label="anchor" href="#slides"><i class="fas fa-link"></i></a>
</h2>
<p>Slides for Nils’ Input:</p>
<div class="shareagain" style="min-width:300px;margin:1em auto;max-width:800px;">
<iframe src="https://computationalmovementanalysis.github.io/Slides/introduction2git.html" width="800" height="450" style="border:2px solid currentColor;" loading="lazy" allowfullscreen></iframe>
<script>fitvids('.shareagain', {players: 'iframe'});</script>
</div>

</div>
<div id="preperation" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Preperation<a class="anchor" aria-label="anchor" href="#preperation"><i class="fas fa-link"></i></a>
</h2>
<div id="folder-structure" class="section level3" number="2.2.1">
<h3>
<span class="header-section-number">2.2.1</span> Folder structure for this course<a class="anchor" aria-label="anchor" href="#folder-structure"><i class="fas fa-link"></i></a>
</h3>
<p>By this point, you probably have created a folder for this course somewhere on your computer. In our example, we assume this folder is located here: <code>C:/Users/yourname/semester1/Modul_CMA</code> (mentally replace this with your actual path). Before we dive into the exercises, take a minute to think about how you are going to structure your files in this folder. This course will take place over 6 weeks, and in each week you will receive or produce various files. We recommend creating a separate folder for each week, and one folder for the semester project, like so:</p>
<pre><code>Course Folder (C:\\Users\\yourname\\semester1\\Modul_CMA)
 ¦--week0                                                
 ¦--week1                                                
 ¦--week2                                                
 ¦--week3                                                
 ¦--week4                                                
 ¦--week5                                                
 ¦--week6                                                
 °--semester_project </code></pre>
<p>For the R-exercises that take place in weeks 0 to 5, we recommend that you create a new RStudio Project each week in subdirectory of the appropriate week. For example, this week your folder structure could look like this:</p>
<pre><code>Folder Week 0 (C:\\Users\\yourname\\semester2\\Modul_CMA\\week1)
 ¦--slides.pdf                                                  
 ¦--my_notes.docx                                               
 ¦--seminar_screenshot.jpg                                      
 °--week0-rexercise                                             
     ¦--week0-rexercise.Rproj                                   
     ¦--wildschwein_BE.csv                                      
     °--my_solution.Rmd   </code></pre>
<p>Note:</p>
<ul>
<li>the RStudio Project is located in a subfolder of `<code>and named</code>week0-rexercise`.</li>
<li>
<code>week0-rexercise</code> is the project’s <em>directory name</em> and the <em>project name</em>
</li>
<li>we realize that that the week number is redundant, there is a reason<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;You will see the project names of all your RStudio Projects listed in RStudio. Having the week number in the project name keeps you from getting confused on which project you are working on.&lt;/p&gt;"><sup>3</sup></a> for this</li>
<li>this means each week is a fresh start (which has pros and cons)</li>
</ul>
</div>
<div id="create-an-rstudio-project-for-the-first-week" class="section level3" number="2.2.2">
<h3>
<span class="header-section-number">2.2.2</span> Create an RStudio <em>project</em> for the first week<a class="anchor" aria-label="anchor" href="#create-an-rstudio-project-for-the-first-week"><i class="fas fa-link"></i></a>
</h3>
<p>Create a new <em>RStudio Project</em> (File &gt; New Project &gt; New Directory &gt; New Project).</p>
<ol style="list-style-type: decimal">
<li>Click on “Browse” and switch to <em>your equivalent</em> of the folder `` (the project we are about to initiate will be be created in a subdirectory of this folder). Click on “open” to confirm the selection</li>
<li>In the field “Directory name”, type <code>week0-rexercise</code>. This will be the name of your RStudio project and it’s parent directory.</li>
<li>Check the option “Create a git repository”</li>
<li>Click on “Create Project”</li>
</ol>
<p><strong>You are all set! You can start working on the tasks of exercise 1.</strong></p>
<!-- Create a new .R (or .Rmd) File and divide it into the sections necessary in a classical Data Science workflow. In .R Files, "Sections" can be created within RStudio by adding Comments (`#`) with at least 3 trailing dashes, equal, or pound signs ( `-`, `=`,`#`). In .Rmd Files, their are created with leading pound signs (`#`). -->
<!-- Sections allow code folding (try clicking on the small triangle next to the line number) and facilitate navigation (try the shortcut: `Shift`+`Alt`+`J`). We recommend following sections: -->
<!-- - Loading environment / libraries -->
<!-- - Data import -->
<!-- - Data cleansing -->
<!-- - Data analysis and visualization -->

</div>
</div>
<div id="w1-tasks-and-inputs" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Tasks and inputs<a class="anchor" aria-label="anchor" href="#w1-tasks-and-inputs"><i class="fas fa-link"></i></a>
</h2>
<p>Before starting with the task:</p>
<ol style="list-style-type: decimal">
<li>make sure you have read and followed the instructions in section <a href="w0-preparation.html#w0-preparation">Preparation</a>
</li>
<li>In RStudio, open the RStudio Project you created for this week if you haven’t done so already. You can see that you are in an RStudio Project if the project’s name is visible next to the little RStudio logo in the top right corner of RStudio (otherwise it will read <code>Project: (None)</code>).</li>
<li>Download the wildboar movement data here: <a href="https://github.com/ComputationalMovementAnalysis/FS21/raw/master/00_Rawdata/wildschwein_BE.csv">wildschwein_BE.csv</a> (right click “Save target as..”)</li>
</ol>
<p>Once you have set everything up, commit your file to your git repo in the following manner:</p>

<div class="rmdtip">
<ol style="list-style-type: decimal">
<li>Save your (R/RMarkdown) file</li>
<li>Switch to the “Git”-Tab in the pane in the top right corner</li>
<li>Click “commit” to open the “commit-Window”</li>
<li>Click in the checkbox next to the file(s) you want to commit</li>
<li>Add a commit message to explain what you are committing (e.g. “<code>initial commit</code>”)</li>
<li>Click on “commit” to commit your changes
</li>
</ol>
</div>

<div id="task-1-import-data" class="section level3" number="2.3.1">
<h3>
<span class="header-section-number">2.3.1</span> Task 1: Import data<a class="anchor" aria-label="anchor" href="#task-1-import-data"><i class="fas fa-link"></i></a>
</h3>
<p>Create a new R- (or RMarkdown) file and begin by loading the following packages:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span>        <span class="co"># to import tabular data (e.g. csv)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>        <span class="co"># to manipulate (tabular) data</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>      <span class="co"># to visualize data</span></code></pre></div>
<p>Move the file <code>wildschwein_BE.csv</code> into your project directory and import it into <code>r</code> as a <code>data.frame</code>. Assign correct column types as necessary and make sure the time zone is set correctly for the date/time column.</p>
<p>Note: We recommend using the <code>readr</code> package to import your data (they all begin with <code>read_*</code>, note the underscore). These functions are less error prone than the base <code>R</code> functions (<code>read.*</code>, note the period). Specifically for the wild boar data, we recommend <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code>.</p>
<p>Commit your changes as described <a href="exercise-1.html#w1-tasks-and-inputs">in the beginning</a>. Write a meaningful commit message (e.g. “<code>completed task 1</code>”).</p>
</div>
<div id="task-2-explore-data" class="section level3" number="2.3.2">
<h3>
<span class="header-section-number">2.3.2</span> Task 2: Explore Data<a class="anchor" aria-label="anchor" href="#task-2-explore-data"><i class="fas fa-link"></i></a>
</h3>
<p>We will use a range of different visualization tools (i.e. R-packages) in this course. Several packages techniques have emerged in recent years, each with their specific strengths and weaknesses. While <code><a href="https://rdrr.io/r/base/plot.html">base::plot()</a></code>is quick and simple, it not very scalable with growing complexity. <code>ggplot2</code> offers solutions for most use cases and has an elegant, consistent syntax that is easy to get accustomed to. We will get to know other techniques later in the course.</p>
<p>Get an overview of your data by creating a first “map-like” plot of your data producing a simple scatter plot with <code>ggplot2</code>.
Setting up a <code>ggplot</code> with our data is done using the command <code>ggplot(wildschwein_BE, aes(Long, Lat, colour = TierID))</code>. Creating a map is done via the basic scatter plot command <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>.</p>
<p>Assigning every individual its own colour is done using the <code>ggplot</code> argument <code>colour =</code>.</p>
<p>Commit your changes as described <a href="exercise-1.html#w1-tasks-and-inputs">in the beginning</a>. Have a look at your commit history by clicking on “History” in the “Git”-Pane.</p>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="W01_05_tasks_and_inputs_files/figure-html/unnamed-chunk-4-1.png" alt="Your plot should look something like this." width="672"><p class="caption">
Figure 2.1: Your plot should look something like this.
</p>
</div>
</div>
<div id="input-handling-spatial-data" class="section level3" number="2.3.3">
<h3>
<span class="header-section-number">2.3.3</span> Input: Handling spatial data<a class="anchor" aria-label="anchor" href="#input-handling-spatial-data"><i class="fas fa-link"></i></a>
</h3>
<p>Until now, we’ve stored our location data within data frames as Lat/Long columns. This works well for many tasks, but sometimes we need special <em>spatial</em> classes to handle our trajectories. We will get to know such cases in our next tasks, but first we need to convert our <code>data.frame</code> into a spatial object.</p>
<p>We will largely rely on <code>sf</code>when working with vector data in <code>R</code>. In order to transform our <code>data.frame</code> into an sf object, we need to use the function <code><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf()</a></code> while specifying the columns storing the coordinates and the coordinate reference system.</p>
<p>(At this point, we assume you know what a Coordinate Reference Systems is. Check out <a href="https://www.earthdatascience.org/courses/earth-analytics/spatial-data-r/intro-to-coordinate-reference-systems/">this link</a> if this is not the case.)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>

<span class="va">wildschwein_BE_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">wildschwein_BE</span>, 
                              coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Long"</span>, <span class="st">"Lat"</span><span class="op">)</span>, 
                              crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></code></pre></div>
<p>Notice how <code>st_as_sf</code> takes the EPSG code for the <code>crs =</code> argument. You can find a lot of useful information on Coordinate Reference Systems (including EPSG Codes, etc.) under <a href="http://epsg.io">epsg.io</a>.<br>
Let’s compare our original <code>data.frame</code> with this new <code>sf</code> object:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wildschwein_BE</span></code></pre></div>
<pre><code>## # A tibble: 51,246 × 6
##    TierID TierName CollarID DatetimeUTC           Lat  Long
##    &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt; &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;
##  1 002A   Sabi        12275 2014-08-22 21:00:12  47.0  7.05
##  2 002A   Sabi        12275 2014-08-22 21:15:16  47.0  7.05
##  3 002A   Sabi        12275 2014-08-22 21:30:43  47.0  7.05
##  4 002A   Sabi        12275 2014-08-22 21:46:07  47.0  7.05
##  5 002A   Sabi        12275 2014-08-22 22:00:22  47.0  7.05
##  6 002A   Sabi        12275 2014-08-22 22:15:10  47.0  7.05
##  7 002A   Sabi        12275 2014-08-22 22:30:13  47.0  7.05
##  8 002A   Sabi        12275 2014-08-22 22:45:11  47.0  7.05
##  9 002A   Sabi        12275 2014-08-22 23:00:27  47.0  7.05
## 10 002A   Sabi        12275 2014-08-22 23:15:41  47.0  7.05
## # … with 51,236 more rows</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wildschwein_BE_sf</span></code></pre></div>
<pre><code>## Simple feature collection with 51246 features and 4 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 7.019889 ymin: 46.97125 xmax: 7.112075 ymax: 47.01882
## Geodetic CRS:  WGS 84
## # A tibble: 51,246 × 5
##    TierID TierName CollarID DatetimeUTC                    geometry
##  * &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt; &lt;dttm&gt;                      &lt;POINT [°]&gt;
##  1 002A   Sabi        12275 2014-08-22 21:00:12 (7.049618 46.99317)
##  2 002A   Sabi        12275 2014-08-22 21:15:16 (7.049509 46.99416)
##  3 002A   Sabi        12275 2014-08-22 21:30:43 (7.049406 46.99383)
##  4 002A   Sabi        12275 2014-08-22 21:46:07 (7.049217 46.99375)
##  5 002A   Sabi        12275 2014-08-22 22:00:22 (7.049359 46.99375)
##  6 002A   Sabi        12275 2014-08-22 22:15:10 (7.049363 46.99382)
##  7 002A   Sabi        12275 2014-08-22 22:30:13 (7.049326 46.99387)
##  8 002A   Sabi        12275 2014-08-22 22:45:11 (7.049237 46.99395)
##  9 002A   Sabi        12275 2014-08-22 23:00:27 (7.048383 46.99481)
## 10 002A   Sabi        12275 2014-08-22 23:15:41 (7.049396 46.99373)
## # … with 51,236 more rows</code></pre>
<p>As you can see, <code><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf()</a></code> has added some metadata to our dataframe (<code>geometry type</code>, <code>dimension</code>, <code>bbox</code>, <code>epsg</code> and <code>proj4string</code>) and replaced the columns <code>Lat</code> and <code>Long</code> with a column named <code>geometry</code>. Other than that, the new <code>sf</code> object is very similar to our original dataframe. In fact, <code>sf</code> objects <em>are</em> essentially <code>dataframes</code>, as you can verify with the function <code><a href="https://rdrr.io/r/base/as.data.frame.html">is.data.frame()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">is.data.frame</a></span><span class="op">(</span><span class="va">wildschwein_BE_sf</span><span class="op">)</span>
<span class="co">## [1] TRUE</span></code></pre></div>
<p>All operations we know from handling <code>data.frames</code> can be used on the <code>sf</code> object. Try some out!</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># subset rows</span>
<span class="va">wildschwein_BE_sf</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span>
<span class="va">wildschwein_BE_sf</span><span class="op">[</span><span class="va">wildschwein_BE_sf</span><span class="op">$</span><span class="va">TierName</span> <span class="op">==</span> <span class="st">"Sabi"</span>,<span class="op">]</span>

<span class="co"># subset colums</span>
<span class="va">wildschwein_BE_sf</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></code></pre></div>
<p>Instead of keeping the same data twice (once as a <code>data.frame</code>, and once as an <code>sf</code> object), we will overwrite the <code>data.frame</code> and continue working with the <code>sf</code> object from now on. This saves some memory space in <code>R</code> and avoids confusion.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wildschwein_BE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">wildschwein_BE</span>, 
                          coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Long"</span>, <span class="st">"Lat"</span><span class="op">)</span>, 
                          crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">wildschwein_BE_sf</span><span class="op">)</span> 
<span class="co"># we can remove this sf object, since it just eats up our memory</span></code></pre></div>
</div>
<div id="task-3-project-data-from-wgs84" class="section level3" number="2.3.4">
<h3>
<span class="header-section-number">2.3.4</span> Task 3: Project data from WGS84<a class="anchor" aria-label="anchor" href="#task-3-project-data-from-wgs84"><i class="fas fa-link"></i></a>
</h3>
<p>So what can we do with our new <code>sf</code> object that we couldn’t before? One example is projecting the WGS84 (<code>Lat</code>/<code>Long</code>) coordinates into the new Swiss CRS <code>CH1903+ LV95</code><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;As we’ve mentioned in the first Input, you can look up the EPSG codes under (epsg.io)[&lt;a href="http://epsg.io" class="uri"&gt;http://epsg.io&lt;/a&gt;]. For information specific to Switzerland, check the &lt;a href="https://www.swisstopo.admin.ch/en/knowledge-facts/surveying-geodesy/reference-systems.html"&gt;swisstopo website&lt;/a&gt;&lt;/p&gt;'><sup>4</sup></a>. Do this by using the function <code>st_transform</code>. By the way, do you notice a pattern here? The package <code>sf</code> names most functions for spatial operations with the prefix <code>st_*</code>, just as in PostGIS.</p>
<p>Here’s the resulting <code>sf</code> object from the operation:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wildschwein_BE</span>
<span class="co">## Simple feature collection with 51246 features and 4 fields</span>
<span class="co">## Geometry type: POINT</span>
<span class="co">## Dimension:     XY</span>
<span class="co">## Bounding box:  xmin: 2568153 ymin: 1202306 xmax: 2575154 ymax: 1207609</span>
<span class="co">## Projected CRS: CH1903+ / LV95</span>
<span class="co">## # A tibble: 51,246 × 5</span>
<span class="co">##    TierID TierName CollarID DatetimeUTC                  geometry</span>
<span class="co">##  * &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt; &lt;dttm&gt;                    &lt;POINT [m]&gt;</span>
<span class="co">##  1 002A   Sabi        12275 2014-08-22 21:00:12 (2570409 1204752)</span>
<span class="co">##  2 002A   Sabi        12275 2014-08-22 21:15:16 (2570402 1204863)</span>
<span class="co">##  3 002A   Sabi        12275 2014-08-22 21:30:43 (2570394 1204826)</span>
<span class="co">##  4 002A   Sabi        12275 2014-08-22 21:46:07 (2570379 1204817)</span>
<span class="co">##  5 002A   Sabi        12275 2014-08-22 22:00:22 (2570390 1204818)</span>
<span class="co">##  6 002A   Sabi        12275 2014-08-22 22:15:10 (2570390 1204825)</span>
<span class="co">##  7 002A   Sabi        12275 2014-08-22 22:30:13 (2570387 1204831)</span>
<span class="co">##  8 002A   Sabi        12275 2014-08-22 22:45:11 (2570381 1204840)</span>
<span class="co">##  9 002A   Sabi        12275 2014-08-22 23:00:27 (2570316 1204935)</span>
<span class="co">## 10 002A   Sabi        12275 2014-08-22 23:15:41 (2570393 1204815)</span>
<span class="co">## # … with 51,236 more rows</span></code></pre></div>
<p>Commit your changes as described <a href="exercise-1.html#w1-tasks-and-inputs">in the beginning</a>.</p>
</div>
<div id="input-calculate-convex-hull" class="section level3" number="2.3.5">
<h3>
<span class="header-section-number">2.3.5</span> Input: Calculate Convex Hull<a class="anchor" aria-label="anchor" href="#input-calculate-convex-hull"><i class="fas fa-link"></i></a>
</h3>
<p>Transforming from one Coordinate Reference System to another was one operation where we needed an object with a spatial nature. In this way, we were able to use an off the shelf function to project the coordinates from one CRS to another. In our next example, we again rely on a spatial function: We want to calculate a <a href="https://en.wikipedia.org/wiki/Convex_hull">convex hull</a> per Wild boar. And guess what the function for calculating a convex hull is called in <code>sf</code>? If you guessed <code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_convex_hull()</a></code>, you were right!</p>
<p>By default <code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_convex_hull()</a></code> calculates the convex hull <em>per feature</em>, i.e. <em>per point</em> in our dataset. This of course makes little sense. In order to calculate the convex hull per animal, we need to convert our point- to multipoint-features where each feature contains all positions of one animal. This is achieved in two steps:</p>
<p>First: add a grouping variable to the <code>sf</code> object. Note the new grouping variable in the metadata of the <code>sf</code> object. Other than that, <code>group_by</code> has no effect on our <code>sf</code> object.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">wildschwein_BE_grouped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">wildschwein_BE</span>,<span class="va">TierID</span><span class="op">)</span>

<span class="va">wildschwein_BE_grouped</span>
<span class="co">## Simple feature collection with 51246 features and 4 fields</span>
<span class="co">## Geometry type: POINT</span>
<span class="co">## Dimension:     XY</span>
<span class="co">## Bounding box:  xmin: 2568153 ymin: 1202306 xmax: 2575154 ymax: 1207609</span>
<span class="co">## Projected CRS: CH1903+ / LV95</span>
<span class="co">## # A tibble: 51,246 × 5</span>
<span class="co">## # Groups:   TierID [3]</span>
<span class="co">##    TierID TierName CollarID DatetimeUTC                  geometry</span>
<span class="co">##    &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt; &lt;dttm&gt;                    &lt;POINT [m]&gt;</span>
<span class="co">##  1 002A   Sabi        12275 2014-08-22 21:00:12 (2570409 1204752)</span>
<span class="co">##  2 002A   Sabi        12275 2014-08-22 21:15:16 (2570402 1204863)</span>
<span class="co">##  3 002A   Sabi        12275 2014-08-22 21:30:43 (2570394 1204826)</span>
<span class="co">##  4 002A   Sabi        12275 2014-08-22 21:46:07 (2570379 1204817)</span>
<span class="co">##  5 002A   Sabi        12275 2014-08-22 22:00:22 (2570390 1204818)</span>
<span class="co">##  6 002A   Sabi        12275 2014-08-22 22:15:10 (2570390 1204825)</span>
<span class="co">##  7 002A   Sabi        12275 2014-08-22 22:30:13 (2570387 1204831)</span>
<span class="co">##  8 002A   Sabi        12275 2014-08-22 22:45:11 (2570381 1204840)</span>
<span class="co">##  9 002A   Sabi        12275 2014-08-22 23:00:27 (2570316 1204935)</span>
<span class="co">## 10 002A   Sabi        12275 2014-08-22 23:15:41 (2570393 1204815)</span>
<span class="co">## # … with 51,236 more rows</span></code></pre></div>
<p>Second: use <code><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise()</a></code> to “dissolve” all points into a mulipoint object.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wildschwein_BE_smry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span><span class="va">wildschwein_BE_grouped</span><span class="op">)</span>

<span class="va">wildschwein_BE_smry</span>
<span class="co">## Simple feature collection with 3 features and 1 field</span>
<span class="co">## Geometry type: MULTIPOINT</span>
<span class="co">## Dimension:     XY</span>
<span class="co">## Bounding box:  xmin: 2568153 ymin: 1202306 xmax: 2575154 ymax: 1207609</span>
<span class="co">## Projected CRS: CH1903+ / LV95</span>
<span class="co">## # A tibble: 3 × 2</span>
<span class="co">##   TierID                                                                geometry</span>
<span class="co">##   &lt;chr&gt;                                                         &lt;MULTIPOINT [m]&gt;</span>
<span class="co">## 1 002A   ((2568903 1206200), (2568925 1206207), (2568980 1206197), (2569024 120…</span>
<span class="co">## 2 016A   ((2569231 1205823), (2569245 1205925), (2569247 1206027), (2569251 120…</span>
<span class="co">## 3 018A   ((2568153 1205611), (2568155 1205613), (2568161 1205624), (2568162 120…</span></code></pre></div>
<p>Now we can run <code>st_convex_hull</code> on the new <code>sf</code> object.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_convex_hull</a></span><span class="op">(</span><span class="va">wildschwein_BE_smry</span><span class="op">)</span></code></pre></div>
</div>
<div id="task-4-ploting-spatial-objects" class="section level3" number="2.3.6">
<h3>
<span class="header-section-number">2.3.6</span> Task 4: Ploting spatial objects<a class="anchor" aria-label="anchor" href="#task-4-ploting-spatial-objects"><i class="fas fa-link"></i></a>
</h3>
<p>Using base plot to visualize <code>sf</code> objects is easy enough, just try the following code.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mcp</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="W01_05_tasks_and_inputs_files/figure-html/unnamed-chunk-15-1.png" width="672"></div>
<p>But since we use <code>ggplot</code> extensively, try and plot the object <code>mcp</code> with <code>ggplot</code>. Hint: Use the layer <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code> to add an <code>sf</code> object.
Note: <code>ggplot</code> refuses to use our specified CRS, so we need to force this by specifying <code>datum =</code> in <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf()</a></code>. Try it out.</p>
<p>Commit your changes as described <a href="exercise-1.html#w1-tasks-and-inputs">in the beginning</a>. Have a look at your commit history by clicking on “History” in the “Git”-Pane.</p>
</div>
<div id="w1-importing-raster" class="section level3" number="2.3.7">
<h3>
<span class="header-section-number">2.3.7</span> Input: Importing raster data<a class="anchor" aria-label="anchor" href="#w1-importing-raster"><i class="fas fa-link"></i></a>
</h3>
<p>In the next task, we would like to add a background map to our <code>mcp</code> object. Download the file here: <a href="https://github.com/ComputationalMovementAnalysis/FS21/raw/master/00_Rawdata/pk100_BE.tif">pk100_BE.tif</a>
To import the file into <code>R</code>, we use the package <code>terra</code> with the function <code>rast</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/">terra</a></span><span class="op">)</span>

<span class="va">pk100_BE</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="st">"00_Rawdata/pk100_BE.tif"</span><span class="op">)</span>

<span class="va">pk100_BE</span>
<span class="co">## class       : SpatRaster </span>
<span class="co">## dimensions  : 1821, 2321, 3  (nrow, ncol, nlyr)</span>
<span class="co">## resolution  : 5, 5  (x, y)</span>
<span class="co">## extent      : 2567000, 2578605, 1199996, 1209101  (xmin, xmax, ymin, ymax)</span>
<span class="co">## coord. ref. : CH1903+ / LV95 (EPSG:2056) </span>
<span class="co">## source      : pk100_BE.tif </span>
<span class="co">## names       : pk1_1, pk1_2, pk1_3 </span>
<span class="co">## min values  :     0,     0,     0 </span>
<span class="co">## max values  :   255,   255,   255</span></code></pre></div>
<p><code>pk100_BE_2056.tif</code> is a three layered geotiff File. The above console output shows some metadata including the resolution, extent and the names of our layers (<code>pk1_1</code>, <code>pk1_2</code>etc). With the default <code>plot</code> method, each layer is displayed individually:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">pk100_BE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="W01_05_tasks_and_inputs_files/figure-html/unnamed-chunk-18-1.png" width="672"></div>
<p>With <code>plotRGB</code> all three layers are combined into a single image:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plotRGB.html">plotRGB</a></span><span class="op">(</span><span class="va">pk100_BE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="W01_05_tasks_and_inputs_files/figure-html/unnamed-chunk-19-1.png" width="672"></div>
</div>
<div id="task-5-adding-a-background-map" class="section level3" number="2.3.8">
<h3>
<span class="header-section-number">2.3.8</span> Task 5: Adding a background map<a class="anchor" aria-label="anchor" href="#task-5-adding-a-background-map"><i class="fas fa-link"></i></a>
</h3>
<p>There are multiple ways to add a background map in <code>ggplot</code>, many require additional packages. This is a good opportunity to get to know a completely different package for creating maps: <code>tmap</code> (“thematic map”). This package was developed with a syntax very similar to <code>ggplot2</code>, which makes it easy to learn.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-tmap/tmap">tmap</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">pk100_BE</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_rgb</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="W01_05_tasks_and_inputs_files/figure-html/unnamed-chunk-20-1.png" width="672"></div>
<p>As you can see, plotting layers in <code>tmap</code> is combined with the <code>+</code> sign, just as in <code>ggplot2</code>. In <code>tmap</code> however, each layer consists of two objects: a <code><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape()</a></code> in which the data is called, and a <code>tm_*</code> object in which we define how the data is visualized (<code><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_rgb()</a></code> states that it is plotted as an RGB Raster Layer). Add the object <code>mcp</code> to the plot in this manner. Read <a href="https://cran.r-project.org/web/packages/tmap/vignettes/tmap-getstarted.html">the vignette</a> if you are having trouble.</p>
<p><img src="W01_05_tasks_and_inputs_files/figure-html/unnamed-chunk-21-1.png" width="672"><img src="W01_05_tasks_and_inputs_files/figure-html/unnamed-chunk-21-2.png" width="672"></p>
<p>Commit your changes as described <a href="exercise-1.html#w1-tasks-and-inputs">in the beginning</a>.</p>
</div>
<div id="task-6-create-an-interactive-map" class="section level3" number="2.3.9">
<h3>
<span class="header-section-number">2.3.9</span> Task 6: Create an interactive map<a class="anchor" aria-label="anchor" href="#task-6-create-an-interactive-map"><i class="fas fa-link"></i></a>
</h3>
<p>Rerun the <code>tmap()...</code> command from the previous task, but switch the plotting mode to “view”” (<code>tmap_mode("view")</code>) beforehand. Omit the raster layer (<code>pk100_BE</code>), you won’t be needing it.</p>
<p>Commit your changes as described <a href="exercise-1.html#w1-tasks-and-inputs">in the beginning</a>. Have a look at your commit history by clicking on “History” in the “Git”-Pane.</p>

<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bryan2021" class="csl-entry">
Bryan, Jenny, and Jim Heister. 2021. <em>Happy Git and GitHub for the useR</em>. <a href="https://happygitwithr.com/">https://happygitwithr.com/</a>.
</div>
<div id="ref-chacon2014" class="csl-entry">
Chacon, Scott, and Ben Straub. 2014. <em>Pro Git</em>. 2nd Edition. Apress. <a href="https://git-scm.com/book/en/v2">https://git-scm.com/book/en/v2</a>.
</div>
<div id="ref-wickham2017" class="csl-entry">
Wickham, Hadley, and Garrett Grolemund. 2017. <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. 1st ed. O’Reilly Media, Inc.
</div>
</div>
</div>
</div>
</div>










  <div class="chapter-nav">
<div class="prev"><a href="w0-preparation.html"><span class="header-section-number">1</span> Preparation</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#exercise-1"><span class="header-section-number">2</span> Exercise 1</a></li>
<li><a class="nav-link" href="#slides"><span class="header-section-number">2.1</span> Slides</a></li>
<li>
<a class="nav-link" href="#preperation"><span class="header-section-number">2.2</span> Preperation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#folder-structure"><span class="header-section-number">2.2.1</span> Folder structure for this course</a></li>
<li><a class="nav-link" href="#create-an-rstudio-project-for-the-first-week"><span class="header-section-number">2.2.2</span> Create an RStudio project for the first week</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#w1-tasks-and-inputs"><span class="header-section-number">2.3</span> Tasks and inputs</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#task-1-import-data"><span class="header-section-number">2.3.1</span> Task 1: Import data</a></li>
<li><a class="nav-link" href="#task-2-explore-data"><span class="header-section-number">2.3.2</span> Task 2: Explore Data</a></li>
<li><a class="nav-link" href="#input-handling-spatial-data"><span class="header-section-number">2.3.3</span> Input: Handling spatial data</a></li>
<li><a class="nav-link" href="#task-3-project-data-from-wgs84"><span class="header-section-number">2.3.4</span> Task 3: Project data from WGS84</a></li>
<li><a class="nav-link" href="#input-calculate-convex-hull"><span class="header-section-number">2.3.5</span> Input: Calculate Convex Hull</a></li>
<li><a class="nav-link" href="#task-4-ploting-spatial-objects"><span class="header-section-number">2.3.6</span> Task 4: Ploting spatial objects</a></li>
<li><a class="nav-link" href="#w1-importing-raster"><span class="header-section-number">2.3.7</span> Input: Importing raster data</a></li>
<li><a class="nav-link" href="#task-5-adding-a-background-map"><span class="header-section-number">2.3.8</span> Task 5: Adding a background map</a></li>
<li><a class="nav-link" href="#task-6-create-an-interactive-map"><span class="header-section-number">2.3.9</span> Task 6: Create an interactive map</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Computational Movement Analysis: Patterns and Trends in Environmental Data</strong>: Master ENR, Spring Semester 2022" was written by Patrick Laube, Nils Ratnaweera, Nikolaos Bakogiannis. It was last built on 30 March, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
